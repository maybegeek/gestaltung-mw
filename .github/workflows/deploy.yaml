name: mwmd per pandoc umwandeln

on: push

jobs:
  convert_via_pandoc:
    runs-on: ubuntu-latest
    steps:
      - name: Repository Checkout ...
        uses: actions/checkout@v2

      - name: Ablage
        run: mkdir Ablage

      - name: Setup timezone
        uses: zcong1993/setup-timezone@master
        with:
          timezone: Europe/Berlin

      - name: Timestamp ...
        run: echo "MWDW_TIMESTAMP=`date +'%Y-%m-%d--%H-%M-%S'`" >> $GITHUB_ENV

      - name: Pandoc/LaTeX-Image ...
        uses: docker://pandoc/latex
        with:
          entrypoint: /bin/sh
          args: >-
            -c "
             tlmgr update --self &&
             tlmgr install titling hanging &&
             pandoc --standalone --pdf-engine=xelatex --template=layout/mwmd.tex layout/mwmd.yaml mwmd.md --output=Ablage/mwmd-${{ env.MWDW_TIMESTAMP }}.pdf
            "

      - name: Artifacts ...
        uses: actions/upload-artifact@master
        with:
          name: Gestaltungsrichtlinien-${{ env.MWDW_TIMESTAMP }}
          path: Ablage
